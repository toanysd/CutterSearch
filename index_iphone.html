<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>é‡‘å‹ãƒ»æŠœå‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  V4.381 / Há»‡ thá»‘ng quáº£n lÃ½ khuÃ´n dao cáº¯t</title>
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Main stylesheet -->
  <link rel="stylesheet" href="styles.css">
  
  <!-- Meta tags -->
  <meta name="description" content="é‡‘å‹ãƒ»æŠœå‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  V4.381 - iPadæœ€é©åŒ–ã€3åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ / Há»‡ thá»‘ng quáº£n lÃ½ khuÃ´n dao cáº¯t V4.381 - Tá»‘i Æ°u iPad, layout 3 cá»™t">
  <meta name="keywords" content="é‡‘å‹,æŠœå‹,æ¤œç´¢,ç®¡ç†,mold,cutter,search,management,iPad,optimized">
  
  <!-- iPad specific meta tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="é‡‘å‹æŠœå‹ V4.381">
</head>
<body>
  <!-- Main Layout: 2 pháº§n chia theo chiá»u dá»c cho iPad -->
  <div class="main-ipad-layout">
    
    <!-- PHáº¦N 1: Khu vá»±c thao tÃ¡c nhanh (trÃªn, chiáº¿m ~50vh) -->
    <div class="top-ipad-panel">
      <!-- Header -->
      <header class="dynamic-header all">
        <h1>ğŸ”§ é‡‘å‹ãƒ»æŠœå‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  V4.381</h1>
        <div class="header-subtitle">iPadæœ€é©åŒ– 3åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ / Tá»‘i Æ°u iPad - Layout 3 cá»™t</div>
      </header>
      
      <!-- 3 Column Layout Container -->
      <div class="three-column-container">
        
        <!-- Cá»˜T 1: NhÃ³m tÃ¬m kiáº¿m vÃ  lá»c -->
        <div class="search-filter-column">
          <div class="column-title">æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ / TÃ¬m kiáº¿m & Lá»c</div>
          
          <!-- Toggle chá»n loáº¡i (Radio buttons) -->
          <div class="type-toggle-group">
            <label class="toggle-radio">
              <input type="radio" name="typeToggle" value="all" checked onchange="toggleCategory('all')">
              <span class="toggle-text">å…¨ã¦</span>
            </label>
            <label class="toggle-radio">
              <input type="radio" name="typeToggle" value="mold" onchange="toggleCategory('mold')">
              <span class="toggle-text">é‡‘å‹</span>
            </label>
            <label class="toggle-radio">
              <input type="radio" name="typeToggle" value="cutter" onchange="toggleCategory('cutter')">
              <span class="toggle-text">æŠœå‹</span>
            </label>
          </div>
          
          <!-- Search Input -->
          <div class="search-input-wrapper">
            <input type="text" id="searchInput" placeholder="ã‚³ãƒ¼ãƒ‰ãƒ»åå‰ãƒ»ã‚µã‚¤ã‚º..." maxlength="25" autocomplete="off">
            <button class="clear-search-btn" id="clearSearchBtn" onclick="clearSearch()" style="display:none;" title="ã‚¯ãƒªã‚¢ / XÃ³a">Ã—</button>
          </div>
          
          <!-- Search Suggestions -->
          <div id="searchSuggestions" class="search-suggestions" style="display:none;">
            <div class="suggestions-header">
              <span class="suggestions-title">æ¤œç´¢å€™è£œ / Gá»£i Ã½</span>
              <button class="clear-history-btn" onclick="clearSearchHistory()">å±¥æ­´ã‚¯ãƒªã‚¢</button>
            </div>
            <div id="suggestionsList" class="suggestions-list">
              <!-- Suggestions sáº½ Ä‘Æ°á»£c populate á»Ÿ Ä‘Ã¢y -->
            </div>
            <div class="suggestions-footer">
              <div class="popular-searches">
                <div class="popular-title">äººæ°—æ¤œç´¢ / Phá»• biáº¿n</div>
                <div class="popular-tags">
                  <span class="popular-tag" onclick="selectSuggestion('JAE')">JAE</span>
                  <span class="popular-tag" onclick="selectSuggestion('025-3551')">025-3551</span>
                  <span class="popular-tag" onclick="selectSuggestion('270x270')">270x270</span>
                  <span class="popular-tag" onclick="selectSuggestion('PS0.8')">PS0.8</span>
                  <span class="popular-tag" onclick="selectSuggestion('ãƒ†ãƒ•ãƒ­ãƒ³')">ãƒ†ãƒ•ãƒ­ãƒ³</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Filters -->
          <div class="filter-group">
            <select id="fieldFilterA" class="field-filter" onchange="handleFieldFilterChange()" aria-label="ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼">
              <option value="all">å…¨é …ç›® / Táº¥t cáº£ trÆ°á»ng</option>
            </select>
            
            <select id="valueFilterB" class="value-filter" onchange="handleValueFilterChange()" aria-label="å€¤ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼">
              <option value="all">å…¨ã¦ / Táº¥t cáº£</option>
            </select>
            
            <button class="reset-btn" onclick="resetFilters()" title="ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ">
              ãƒªã‚»ãƒƒãƒˆ / Reset
            </button>
          </div>
        </div>

        <!-- Cá»˜T 2: Káº¿t quáº£ nhanh - Dáº NG Báº¢NG THEO CHIá»€U NGANG -->
        <div class="quick-results-column">
          <div class="column-title">
            ã‚¯ã‚¤ãƒƒã‚¯çµæœ / Káº¿t quáº£ nhanh
            <span id="resultsCount" class="results-count-badge">0 ä»¶</span>
          </div>
          
          <!-- Quick Results Table - Dáº NG Báº¢NG THAY VÃŒ GRID -->
          <div class="quick-results-table-container">
            <table class="quick-results-table" id="quickResultsTable">
              <thead>
                <tr>
                  <th class="quick-col-type">ç¨®é¡</th>
                  <th class="quick-col-code">ã‚³ãƒ¼ãƒ‰</th>
                  <th class="quick-col-name">åå‰</th>
                  <th class="quick-col-size">ã‚µã‚¤ã‚º</th>
                  <th class="quick-col-location">ä½ç½®</th>
                  <th class="quick-col-company">ä¼šç¤¾</th>
                </tr>
              </thead>
              <tbody id="quickResultsBody">
                <!-- Quick results sáº½ Ä‘Æ°á»£c populate á»Ÿ Ä‘Ã¢y bá»Ÿi JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Cá»˜T 3: NÃºt cáº­p nháº­t -->
        <div class="action-buttons-column">
          <div class="column-title">æ›´æ–° / Cáº­p nháº­t</div>
          
          <!-- Action Buttons -->
          <div class="action-buttons-grid">
            <button id="updateLocationBtn" class="action-btn location" disabled title="ä½ç½®æ›´æ–° / Cáº­p nháº­t vá»‹ trÃ­">
              <div class="btn-icon">ğŸ“</div>
              <div class="btn-text">
                <div class="btn-primary-text">ä½ç½®æ›´æ–°</div>
                <div class="btn-secondary-text">Cáº­p nháº­t vá»‹ trÃ­</div>
              </div>
            </button>
            
            <button id="updateShipmentBtn" class="action-btn shipment" disabled title="æ¬é€æ›´æ–° / Cáº­p nháº­t váº­n chuyá»ƒn">
              <div class="btn-icon">ğŸšš</div>
              <div class="btn-text">
                <div class="btn-primary-text">æ¬é€æ›´æ–°</div>
                <div class="btn-secondary-text">Váº­n chuyá»ƒn</div>
              </div>
            </button>
            
            <button id="updateTeflonBtn" class="action-btn teflon" disabled title="ãƒ†ãƒ•ãƒ­ãƒ³æ›´æ–° / Cáº­p nháº­t Teflon">
              <div class="btn-icon">ğŸ›¡ï¸</div>
              <div class="btn-text">
                <div class="btn-primary-text">ãƒ†ãƒ•ãƒ­ãƒ³</div>
                <div class="btn-secondary-text">Máº¡ Teflon</div>
              </div>
            </button>
            
            <button id="updateCommentBtn" class="action-btn comment" disabled title="ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ  / ThÃªm ghi chÃº">
              <div class="btn-icon">ğŸ’¬</div>
              <div class="btn-text">
                <div class="btn-primary-text">ã‚³ãƒ¡ãƒ³ãƒˆ</div>
                <div class="btn-secondary-text">Ghi chÃº</div>
              </div>
            </button>
          </div>
          
          <!-- Selected Item Info -->
          <div id="selectedInfo" class="selected-info" style="display:none;">
            <div class="selected-title">é¸æŠä¸­ / ÄÃ£ chá»n:</div>
            <div id="selectedItemDetails" class="selected-details">
              <!-- Selected item details sáº½ Ä‘Æ°á»£c populate á»Ÿ Ä‘Ã¢y -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PHáº¦N 2: Báº£ng káº¿t quáº£ chi tiáº¿t hoáº·c trang chi tiáº¿t (dÆ°á»›i, chiáº¿m ~50vh) -->
    <div class="bottom-ipad-panel">
      <div class="results-section">
        
        <!-- Results Header -->
        <div class="results-header">
          <div class="results-info">
            <span class="results-count-full" id="resultsCountBottom">0 ä»¶è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ / 0 káº¿t quáº£</span>
            <span class="selected-count" id="selectedCount" style="display:none;">0 é¸æŠ / 0 Ä‘Ã£ chá»n</span>
          </div>
          
          <div class="results-controls">
            <!-- Selection Actions -->
            <div class="selection-actions">
              <button class="control-btn" onclick="selectAll()" title="å…¨é¸æŠ / Chá»n táº¥t cáº£">
                å…¨é¸æŠ
              </button>
              <button class="control-btn" onclick="clearSelection()" title="é¸æŠè§£é™¤ / Bá» chá»n">
                è§£é™¤
              </button>
              <button class="control-btn primary" id="printSelectedBtn" onclick="printSelected()" style="display:none;" title="é¸æŠå°åˆ· / In Ä‘Ã£ chá»n">
                å°åˆ·
              </button>
            </div>
            
            <!-- View Controls -->
            <div class="view-controls">
              <button class="control-btn" onclick="zoomFit()" title="ã‚ºãƒ¼ãƒ ãƒ•ã‚£ãƒƒãƒˆ / Zoom fit">
                ğŸ” ãƒ•ã‚£ãƒƒãƒˆ
              </button>
            </div>
          </div>
        </div>

        <!-- Full Results Table (Default View) -->
        <div id="fullResultsTable" class="full-results-table">
          <div class="table-container">
            <table class="data-table" id="dataTable">
              <thead>
                <tr>
                  <th class="col-select">
                    <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()" aria-label="å…¨é¸æŠ / Chá»n táº¥t cáº£" title="å…¨é¸æŠ / Chá»n táº¥t cáº£">
                  </th>
                  <th class="col-id sortable" onclick="sortTable('id')">ID / CutterNo</th>
                  <th class="col-name sortable" onclick="sortTable('name')">åç§° / TÃªn</th>
                  <th class="col-size sortable" onclick="sortTable('size')">ã‚µã‚¤ã‚º / Cutline</th>
                  <th class="col-location sortable" onclick="sortTable('location')">å ´æ‰€ / Vá»‹ trÃ­</th>
                  <th class="col-rack-location sortable" onclick="sortTable('rackLocation')">æ£šä½ç½®</th>
                  <th class="col-company sortable" onclick="sortTable('company')">ä¿ç®¡ä¼šç¤¾</th>
                  <th class="col-notes sortable" onclick="sortTable('notes')">å‚™è€ƒ / Ghi chÃº</th>
                </tr>
              </thead>
              <tbody id="dataTableBody">
                <!-- Data sáº½ Ä‘Æ°á»£c populate á»Ÿ Ä‘Ã¢y bá»Ÿi JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Detail View (Hidden by default, hiá»ƒn thá»‹ trong pháº§n 2) -->
        <div id="detailView" class="detail-view" style="display:none;">
          <!-- Detail content sáº½ Ä‘Æ°á»£c render Ä‘á»™ng bá»Ÿi JavaScript -->
          <div class="detail-placeholder">
            <div style="text-align:center; padding:40px; color:#9ca3af; font-style: italic;">
              ã‚¢ã‚¤ãƒ†ãƒ ã‚’é¸æŠã—ã¦ãã ã•ã„ / Vui lÃ²ng chá»n má»™t káº¿t quáº£ Ä‘á»ƒ xem chi tiáº¿t
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div id="loadingIndicator" class="loading-overlay" style="display:none;">
    <div class="loading-content">
      <div class="spinner"></div>
      <span class="loading-text">èª­ã¿è¾¼ã¿ä¸­... / Äang táº£i dá»¯ liá»‡u...</span>
    </div>
  </div>

  <!-- Error Message -->
  <div id="errorMessage" class="error-message" style="display:none;">
    <div class="error-icon">âš ï¸</div>
    <h3>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ / ÄÃ£ xáº£y ra lá»—i</h3>
    <p id="errorText">ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚</p>
    <button class="retry-btn" onclick="location.reload()">å†è©¦è¡Œ / Thá»­ láº¡i</button>
  </div>

  <!-- No Data Message -->
  <div id="noDataMessage" class="no-data-message" style="display:none;">
    <div class="no-data-icon">ğŸ“­</div>
    <h3>ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ / KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u</h3>
    <p>æ¤œç´¢æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ / Vui lÃ²ng thay Ä‘á»•i Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m</p>
    <button class="reset-btn" onclick="resetFilters()">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ / Äáº·t láº¡i bá»™ lá»c</button>
  </div>

  <!-- Success Message (for updates) -->
  <div id="successMessage" class="success-message" style="display:none;">
    <div class="success-icon">âœ…</div>
    <h3>æˆåŠŸ / ThÃ nh cÃ´ng</h3>
    <p id="successText">æ“ä½œãŒå®Œäº†ã—ã¾ã—ãŸã€‚</p>
    <button class="success-btn" onclick="closeSuccessMessage()">OK</button>
  </div>

  <!-- Modal Container (for update forms) -->
  <div id="modalContainer" class="modal-container">
    <!-- Modals sáº½ Ä‘Æ°á»£c táº¡o Ä‘á»™ng bá»Ÿi JavaScript -->
  </div>

  <!-- Debug Info (for development, can be removed in production) -->
  <div id="debugInfo" class="debug-info" style="display:none; position:fixed; bottom:10px; right:10px; background:rgba(0,0,0,0.8); color:white; padding:8px; border-radius:4px; font-size:12px; z-index:10000;">
    <div>Version: V4.381</div>
    <div>Items: <span id="debugItemCount">0</span></div>
    <div>Filtered: <span id="debugFilteredCount">0</span></div>
    <div>Selected: <span id="debugSelectedCount">0</span></div>
  </div>

  <!-- Scripts -->
  <script>
    // Global configuration for iPad optimization
    window.IPAD_OPTIMIZED = true;
    window.VERSION = 'V4.381';
    window.LAYOUT_TYPE = '3_COLUMN_TABLE';
    
    // Prevent zoom on double tap for iPad
    var lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      var now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);
    
    // Prevent zoom on input focus for iPad
    document.addEventListener('touchstart', function(event) {
      if (event.touches.length > 1) {
        event.preventDefault();
      }
    });
    
    // Console log for debugging
    console.log('ğŸ‰ é‡‘å‹ãƒ»æŠœå‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  V4.381 - iPadæœ€é©åŒ– 3åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ');
    console.log('ğŸ“± Layout: 2ãƒ‘ãƒãƒ« (ä¸Š: 3åˆ—æ¤œç´¢ãƒ»çµæœãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ãƒœã‚¿ãƒ³, ä¸‹: ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»è©³ç´°)');
    console.log('ğŸ”§ Features: Radio Toggleé¸æŠ, Quick Table, Touchæœ€é©åŒ–, Modalæ›´æ–°');
  </script>
  
  <!-- Main application script -->
  <script src="script.js"></script>
  
  <!-- Additional iPad optimizations -->
  <script>
    // iPad specific optimizations after DOM load
    document.addEventListener('DOMContentLoaded', function() {
      // Add iPad class to body for specific styling
      if (navigator.userAgent.match(/iPad/i)) {
        document.body.classList.add('ipad-device');
      }
      
      // Optimize viewport for iPad
      if (window.innerWidth >= 768 && window.innerWidth <= 1024) {
        document.body.classList.add('ipad-layout');
      }
      
      // Debug info toggle (remove in production)
      var debugToggleCount = 0;
      document.addEventListener('click', function(e) {
        if (e.target.tagName === 'H1') {
          debugToggleCount++;
          if (debugToggleCount >= 5) {
            var debugInfo = document.getElementById('debugInfo');
            if (debugInfo) {
              debugInfo.style.display = debugInfo.style.display === 'none' ? 'block' : 'none';
            }
            debugToggleCount = 0;
          }
        }
      });
      
      // Update debug info
      function updateDebugInfo() {
        var debugItemCount = document.getElementById('debugItemCount');
        var debugFilteredCount = document.getElementById('debugFilteredCount');
        var debugSelectedCount = document.getElementById('debugSelectedCount');
        
        if (debugItemCount && window.allData) {
          var totalItems = (window.allData.molds || []).length + (window.allData.cutters || []).length;
          debugItemCount.textContent = totalItems;
        }
        
        if (debugFilteredCount && window.filteredData) {
          debugFilteredCount.textContent = window.filteredData.length || 0;
        }
        
        if (debugSelectedCount && window.selectedItems) {
          debugSelectedCount.textContent = window.selectedItems ? window.selectedItems.size : 0;
        }
      }
      
      // Update debug info periodically
      setInterval(updateDebugInfo, 1000);
    });
  </script>
</body>
</html>
